(this["webpackJsonponline-text-editor"]=this["webpackJsonponline-text-editor"]||[]).push([[0],{191:function(e,t,n){},311:function(e,t){},317:function(e,t,n){},319:function(e,t,n){},321:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(67),o=n.n(a);n(191);n(192)(r.a,{trackAllPureComponents:!0});var u=n(13),i=n.n(u),s=n(4),d=n(18),l=n(334),j=n(51),f=n(16),b=n(44),p=Object(b.c)({name:"keyCommand",initialState:{keyCommand:""},reducers:{add:function(e,t){e.keyCommand+=t.payload},clear:function(e){e.keyCommand=""}}}),m=p.actions,O=m.add,h=m.clear,x=p.reducer,v=n(2),S=(n(175),{GRAY_LIGHTEST:"#FFFFFF",GRAY_LIGHTER:"#EBEBEB",GRAY_LIGHT:"#CCCCCC",GRAY_DEFAULT:"#A3A3A3",GRAY_DARK:"#7A7A7A",GRAY_DARKER:"#5C5C5C",GRAY_DARKEST:"#3D3D3D",YELLOW_DEFAULT:"#E4FF1A",GREEN_DEFAULT:"#6EEB83",PURPLE_DEFAULT:"#7e6ab4",PURPLE_LIGHT:"#a192c8"}),_={SAVE_MACOS:"Metas",SAVE_WINDOWS:"Controls"},A={SAVING:{text:"Saving",color:S.YELLOW_DEFAULT},UP_TO_DATE:{text:"Everything is up to date",color:S.GREEN_DEFAULT},NOT_SAVED:{text:"Work is not being saved",color:S.GRAY_LIGHT}},E=(window.localStorage,window.indexedDB.open("documents",4),new(n(176).a)("documents")),D={getAllDocuments:function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.allDocs({include_docs:!0});case 2:return t=e.sent,e.next=5,t;case 5:return e.abrupt("return",e.sent.rows.map((function(e){return e.doc})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),saveDocument:function(){var e=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.put(t,{force:!0});case 2:if(!e.sent.ok){e.next=5;break}return e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=Object(b.b)("documents/getAllDocuments",Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getAllDocuments();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),g=Object(b.c)({name:"document",initialState:{documents:[],currentSelectedDocument:{_id:"",title:"",content:""},loading:!1},reducers:{updateCurrentSelectedDocument:function(e,t){e.currentSelectedDocument=Object.assign(e.currentSelectedDocument,t.payload)},selectDocument:function(e,t){e.currentSelectedDocument=e.documents.find((function(e){return e._id==t.payload}))},addDocument:function(e,t){e.documents.push(t.payload)},updateDocumentOnClient:function(e,t){var n=e.documents.find((function(e){return e._id==t.payload._id}));n&&(Object.assign(n,t.payload),e.currentSelectedDocument=Object.assign(e.currentSelectedDocument,t.payload))}},extraReducers:Object(v.a)({},C.fulfilled,(function(e,t){e.documents=t.payload}))}),w=g.actions,y=(w.updateCurrentSelectedDocument,w.selectDocument),T=w.updateDocumentOnClient;function k(e,t){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.saveDocument(n);case 2:t(g.actions.addDocument(n)),t(y(n._id));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=g.reducer,F=(n(317),n(346)),G=n(338),U=n(344),P=n(3);function I(){return(I=Object(d.a)(i.a.mark((function e(t,n,c){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(!0),t(y(n._id));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(d.a)(i.a.mark((function e(t,n,c){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(c),t(T({_id:n._id,title:c}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(d.a)(i.a.mark((function e(t,n,c){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.saveDocument({_rev:t._rev,_id:t._id,content:t.content,title:n});case 2:r=e.sent,console.log(r),c(!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){var t=e.doc,n=Object(f.c)((function(e){return e.documents})).currentSelectedDocument,c=r.a.useState(!1),a=Object(s.a)(c,2),o=a[0],u=a[1],i=Object(f.b)();return Object(P.jsxs)(l.a,{children:[Object(P.jsx)(l.a,{cursor:"pointer",onClick:function(){return i(y(t._id))},_hover:{backgroundColor:S.PURPLE_LIGHT,color:S.GRAY_LIGHTEST},onDoubleClick:function(){return function(e,t,n){return I.apply(this,arguments)}(i,t,u)},p:13,children:o?Object(P.jsx)(F.a,{onBlur:function(e){return function(e,t,n){return N.apply(this,arguments)}(n,e.target.value,u)},value:t.title,onChange:function(e){return function(e,t,n){return Y.apply(this,arguments)}(i,n,e.target.value)}}):Object(P.jsx)(P.Fragment,{children:Object(P.jsx)("p",{children:t.title})})}),n._id==t._id?Object(P.jsx)(l.a,{w:"80%",h:"3px",backgroundColor:S.PURPLE_DEFAULT}):null]})}var W=function(){var e=Object(f.c)((function(e){return e.documents})).documents,t=Object(f.b)();function n(){return(n=Object(d.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={_id:Date.now().toString(),title:"Untitled Document",content:""},k(t,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(P.jsx)(l.a,{position:"relative",h:"100%",boxShadow:"5px 0px 0px ".concat(S.PURPLE_LIGHT),children:Object(P.jsxs)(G.a,{paddingY:4,marginLeft:4,children:[Object(P.jsxs)(l.a,{children:[Object(P.jsx)("p",{children:"YOUR DOCUMENTS"}),Object(P.jsx)(l.a,{backgroundColor:S.PURPLE_DEFAULT,h:1,w:"50%"})]}),Object(P.jsx)(l.a,{mt:8,children:null===e||void 0===e?void 0:e.map((function(e){return Object(P.jsx)(V,{doc:e},e._id)}))}),Object(P.jsx)(l.a,{mt:5,children:Object(P.jsx)(U.a,{onClick:function(){return function(){return n.apply(this,arguments)}()},children:"Add new document"})})]})})},H=n(340);var B=function(e){var t=e.status;return Object(P.jsxs)(l.a,{display:"flex",alignItems:"center",children:[Object(P.jsx)(l.a,{h:3,w:3,borderRadius:50,backgroundColor:t.color}),Object(P.jsx)(H.a,{ml:2,children:t.text})]})};function K(e,t,n){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(i.a.mark((function e(t,n,c){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.saveDocument({_rev:n._rev,_id:n._id,title:n.title,content:c});case 2:e.sent&&t(T({_id:n._id,content:c}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=function(e){var t=Object(f.c)((function(e){return e.documents})),n=t.currentSelectedDocument,c=t.documents,a=Object(f.c)((function(e){return e.isAutoSave})).isAutoSave,o=Object(f.b)(),u=r.a.useState(j.EditorState.createWithContent(j.ContentState.createFromText(n.content))),i=Object(s.a)(u,2),d=i[0],b=i[1],p=Object(f.c)((function(e){return e.keyCommand})).keyCommand,m=r.a.useState(!1),x=Object(s.a)(m,2),v=x[0],S=x[1],E=r.a.useState(),D=Object(s.a)(E,2),C=D[0],g=D[1];return r.a.useEffect((function(){document.addEventListener("keydown",(function(e){return(e.ctrlKey||e.metaKey)&&(e.preventDefault(),o(O(e.key))),!0})),document.addEventListener("keyup",(function(e){o(h())}))}),[]),r.a.useEffect((function(){var e=d.getCurrentContent().getPlainText();(p.includes(_.SAVE_MACOS)||p.includes(_.SAVE_WINDOWS))&&(C&&clearTimeout(C),S(!0),g(setTimeout((function(){S(!1),K(o,n,e)}),2e3)),o(h()))}),[p]),r.a.useEffect((function(){var e=d.getCurrentContent().getPlainText();if(0==(null===c||void 0===c?void 0:c.length)&&""!=e){var t={_id:Date.now().toString(),title:"Untitled Document",content:e};k(o,t)}""!=n._id&&a&&(C&&clearTimeout(C),S(!0),g(setTimeout((function(){K(o,n,e).then((function(e){S(!1)}))}),2e3)))}),[d.getCurrentContent().getPlainText()]),r.a.useEffect((function(){n&&b(j.EditorState.moveFocusToEnd(j.EditorState.createWithContent(j.ContentState.createFromText(n.content))))}),[n._id]),Object(P.jsx)(l.a,{p:10,children:0==(null===c||void 0===c?void 0:c.length)?Object(P.jsx)(j.Editor,{placeholder:0==(null===c||void 0===c?void 0:c.length)&&"No document found. Type something down here...",editorState:d,onChange:function(e){return b(e)}}):Object(P.jsx)(P.Fragment,{children:""!=n._id?Object(P.jsxs)(l.a,{children:[a?Object(P.jsx)(P.Fragment,{children:v?Object(P.jsx)(B,{status:A.SAVING}):Object(P.jsx)(B,{status:A.UP_TO_DATE})}):Object(P.jsx)(P.Fragment,{children:v?Object(P.jsx)(B,{status:A.SAVING}):Object(P.jsx)(P.Fragment,{children:n.content==d.getCurrentContent().getPlainText()?Object(P.jsx)(B,{status:A.UP_TO_DATE}):Object(P.jsx)(B,{status:A.NOT_SAVED})})}),Object(P.jsx)(j.Editor,{editorState:d,onChange:function(e){return b(e)}})]}):Object(P.jsx)("p",{children:"Select a document to edit or create a new one"})})})},z=(n(319),n(341)),q=n(177),Q=n(14),X=Object(b.c)({name:"autoSave",initialState:{isAutoSave:!0},reducers:{switchAutoSave:function(e){e.isAutoSave=!e.isAutoSave}}}),Z=X.actions.switchAutoSave,$=X.reducer,ee=n(347),te=n(345);var ne=function(){var e=Object(f.c)((function(e){return e.isAutoSave})).isAutoSave,t=Object(f.b)();return Object(P.jsx)(l.a,{mt:4,children:Object(P.jsxs)(ee.a,{align:"center",direction:"row",children:[Object(P.jsx)(te.a,{isChecked:e,onChange:function(){return t(Z())},size:"sm"}),Object(P.jsx)("p",{children:"Auto save"})]})})},ce=function(){var e=Object(f.b)();return r.a.useEffect((function(){e(C())}),[]),Object(P.jsxs)(z.a,{h:"100vh",templateColumns:"repeat(5,1fr)",children:[Object(P.jsx)(z.b,{colSpan:1,children:Object(P.jsx)(W,{})}),Object(P.jsx)(z.b,{colSpan:3,children:Object(P.jsx)(q.a,{children:Object(P.jsx)(Q.c,{children:Object(P.jsx)(Q.a,{exact:!0,path:"/",children:Object(P.jsx)(J,{})})})})}),Object(P.jsx)(z.b,{colSpan:1,children:Object(P.jsx)(ne,{})})]})};ce.whyDidYouRender=!0;var re=ce,ae=Object(b.a)({reducer:{documents:R,keyCommand:x,isAutoSave:$}}),oe=n(342),ue=n(343),ie=(n(43),Object(oe.a)({fonts:{heading:"Open Sans",body:""}}));o.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(ue.a,{theme:ie,children:Object(P.jsx)(f.a,{store:ae,children:Object(P.jsx)(re,{})})})}),document.getElementById("root"))}},[[321,1,2]]]);
//# sourceMappingURL=main.dd06ce90.chunk.js.map